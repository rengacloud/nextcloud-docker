# README #

Что нужно сделать, чтобы начать работу

### В репозитории хранится сервер API для управления сервисами (создание, запуск, остановка и т.п.) RengaServer для совместной работы ###

### Чтобы запустить сервер нужно: ###

Шаги верны для ОС Windows Server 2022

* Установить python версии 3.9
* Склонировать репозиторий в папку c:\rengacloud
* Запустить setup.bat
* Если новый сервер, то создать папки c:\rengacloud\logs, c:\rengacloud\db, c:\rengacloud\storage или восстановить из бэкапа
* Если новый сервер, запустить скрипт создания БД: py build_database.py
* Запустить скрипт резервирование портов: reserve_ports.bat
* Создать Inbound Rule в Windows Defender Firewall: название RengaServer, TCP, ports: 5000, 8250, 8820-9200
* Создать переменную окружения "CLOUD_AGENT_NAME" с именем нового сервера (например, c1)
* Создать переменную окружения "CLOUD_API_PATH" с путем до rengacloud api (например, c:\rengacloud)
- * Запустить скрипт mount_storage_to_cloud.bat (!!пока не нужно!!)
* Для работы бэкапа, нужно настроить rclone для работы с Yandex.Cloud. Нужно запустить команду rclone config. И создать новый remote с именем "RengaCloud".
* Импортировать задачу планировщика Copy_DB_To_Cloud_Storage.xml
* Запустить сервер командой py server.py (т.к. сервер управляет сервисами, то запускать следует с правами администратора)
* Добавить сервер в автозапуск (ярлык start_server)

Ссылка на UI сервера API: http://localhost:5000/api/ui/

